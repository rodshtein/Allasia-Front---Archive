/* Ellipsis, made by me ðŸ˜œ  https://github.com/zamkevich */
import{tick as W}from"svelte";const A="position:absolute;left:0;top:-100%; border:none;opacity:0;visibility:hidden;pointer-events:none;";function E(i,{cutLength:N=0,overflowBadge:y="\u2026",affectNode:s=null,sliceAfter:O=/\p{Letter}/u}={}){let n,t,v=0,f=!0,R=s?s.style.display:null,c=!1,r=new ResizeObserver(L),H=new MutationObserver(D),z=e=>new CustomEvent("update",{detail:e}),j=window.__ellipsis;function g(){if(window.__ellipsisNodesContainer)return window.__ellipsisNodesContainer;{let e=document.createElement("div");return e.setAttribute("ariaHidden",!0),e.style.cssText=A,document.body.append(e),window.__ellipsisNodesContainer=e,window.__ellipsisNodesContainer}}d();async function d(){await C()?(S(),T(),m()):(u(),_())}function S(){let e=i.cloneNode(!0);e.style.position="unset",typeof t=="object"?(t.before(e),t.remove(),t=e):(t=e,i.before(t),g().append(i),_())}function T(){typeof n=="object"&&n.remove(),n=i.cloneNode(!0),g().append(n)}async function a(e,l){await W(),i.dispatchEvent(z({type:e,status:l}))}function p(e){e=="hide"&&(s.style.display="none",c=!0),e=="show"&&(s.style.display=R,c=!1)}async function C(){let e;return typeof t=="object"?(e=t,t.textContent=i.textContent):e=i,c&&p("show"),e.clientHeight<e.scrollHeight?s?(p("hide"),e.clientHeight<e.scrollHeight?(p("show"),a("overflow",!0),!0):(a("overflow",!1),!1)):(a("overflow",!0),!0):(a("overflow",!1),!1)}function k(){return n.textContent="Lg",t.clientHeight>=n.clientHeight}function m(){if(console.log("runned"),k()){let e=t.clientHeight/(t.scrollHeight/100),l=t.style.width;t.style.width="100%",n.style.width=t.clientWidth-1+"px",t.style.width=l,h(Math.round(i.textContent.length/100*e))}else u()}function h(e,l,o=!1){if(o=o||++v,o!=v)return;let M=i.textContent.substr(0,e)+y;n.textContent=M,n.clientHeight>t.clientHeight&&(l==!1?x(--e):setTimeout(()=>h(--e,!0,o),20)),n.clientHeight<=t.clientHeight&&(l==!0?x(e):h(++e,!1,o))}function x(e){for(;!O.test(i.textContent[e-1]);)--e;t.textContent=i.textContent.substr(0,e-N)+y,u()}function _(){H.observe(i,{attributes:!0,characterData:!0,subtree:!0})}function u(){if(!j){let e={};window.Ellipsis=e}f=!0,r.observe(typeof t=="object"?t:i)}let w=!1;function D(){w||(w=!0,setTimeout(()=>{r.disconnect(),d(),w=!1},300))}let b=!1;function L(){f?f=!1:b||(b=!0,setTimeout(async()=>{typeof t=="object"?(r.disconnect(),await C()?m():u()):d(),b=!1},300))}return{update(e){e.affectNode&&(s=e.affectNode)},destroy(){r.disconnect(),H.disconnect()}}}export{E as default};
